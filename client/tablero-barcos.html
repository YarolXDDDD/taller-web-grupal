<!DOCTYPE html>
<html lang="es-VE">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta author="Oscar Manrique"/>
    <meta name="description" content="Este es un juego de Batalla Naval" />
    <meta name="keywords" content="Batalla Naval, juego, taller, semestre" />
    <meta name="robots" content="index,follow" />
    <title>Batalla Naval | Tablero Barcos</title>
    <link rel="icon" href="https://seguropordias.com/img/contenido/barco-famoso-titanic.jpg" type="image/png" size="16x16 32x32 64x64" />
    <link rel="stylesheet" href="styles/styles.css" type="text/css"/>
    <link rel="stylesheet" href="styles/tablero-barcos-styles.css" type="text/css"/>
    <script src="script/script.js" type="text/javascript">     </script>
</head>
<body>

    <script>
        crearTablero(1);

        const ws= new WebSocket('ws://localhost:8080');
        
        ws.addEventListener('open', ()=>{
            console.log('Conectado al servidor');
        })

        ws.addEventListener('close', ()=>{
            console.log('desconectado del servidor');
        })

        ws.addEventListener('message', (event)=>{
            try{
                const mensaje= JSON.parse(event.data);
                switch (mensaje.type){
                    case 'gameCreated':{
                        console.log(mensaje.players[0].name);
                        alert('revisa la consola');
                        localStorage.setItem('partidaActiva',mensaje.gameId);
                    }
                        break;
                    case 'playerJoined':{
                        console.log('te has unido a un juego exitosamente');
                    }
                        break;
                    case 'start':{
                        console.log('se ha iniciado el juego');
                    } 
                    case 'error':{
                        alert(mensaje.message);
                        event.preventDefault();
                    }
                    break;
                    default:{
                        alert('no se ha podido procesar el mensaje');
                        event.preventDefault();
                        }
                }
            }
            catch(error)
            {
                alert('error al parsear el mensaje');
            }
        })

        document.getElementById('creacion-game').addEventListener('click',()=>{

            ws.send(JSON.stringify({type:'create', playerName: localStorage.getItem('nombreJugador')}))
        })

        document.getElementById('union-game').addEventListener('click',()=>{

            ws.send(JSON.stringify({type:'join', playerName: localStorage.getItem('nombreJugador'), gameID:'124', cantidadJugadores: localStorage.getItem('cantidadJugadores')}))
        })
        
    </script>
</body>
</html>